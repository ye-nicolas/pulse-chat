# webflux
server.port=${SERVER_PORT:8809}
spring.webflux.base-path=${WEB_BASE_PATH:/pulse-chat}
spring.application.name=pulse-chat
# RSocket
spring.rsocket.server.transport=websocket
spring.rsocket.server.port=${WEBSOCKET_SERVER_PORT:8810}
spring.rsocket.server.mapping-path=${SOCKET_BASE_PATH:/web-socket}
# r2dbc-db
pulse-chat.db.host=${PULSE_CHAT_DB_HOST:localhost}
pulse-chat.db.port=${PULSE_CHAT_DB_PORT:5433}
pulse-chat.db.username=${PULSE_CHAT_DB_USERNAME:nicolas}
pulse-chat.db.password=${PULSE_CHAT_DB_PASSWORD:123456789}
pulse-chat.db.database=${PULSE_CHAT_DB_DATABASE:pulse_chat}
pulse-chat.db.schema=${PULSE_CHAT_DB_SCHEMA:pulse_chat}
pulse-chat.db.connection-timeout=${PULSE_CHAT_DB_CONNECTION_TIMEOUT:30}
# r2dbc-pool
pulse-chat.db.pool.initial-size=${PULSE_CHAT_DB_POOL_INITIAL_SIZE:10}
pulse-chat.db.pool.max-size=${PULSE_CHAT_DB_POOL_MAX_SIZE:30}
# 30 Minutes
pulse-chat.db.pool.max-idle-time=${PULSE_CHAT_DB_POOL_MAX_IDLE_TIME:1800}
pulse-chat.db.pool.max-acquire-time=${PULSE_CHAT_DB_POOL_MAX_ACQUIRE_TIME:10}
pulse-chat.db.pool.max-create-connection-time=${PULSE_CHAT_DB_POOL_MAX_CREATE_CONNECTION_TIME:5}
pulse-chat.db.pool.acquire-retry=${PULSE_CHAT_DB_POOL_ACQUIRE_RETRY:3}
# log
logging.level.root=${LOGGING_LEVEL_ROOT:INFO}
logging.level.sql=${LOGGING_LEVEL_SQL:INFO}
logging.dir.root=${LOGGING_DIR_ROOT:log/pulse-chat}
logging.file.name=${LOGGING_FILE_NAME:app-pulse-chat}
# jwt
jwt.key=xRaudYGoGyG9ysF/8garnYoJSaFuH+1JpV2LoLYvSas=
auth.access.expires-minute=${ACCESS_EXPIRES_MINUTE:5}
auth.refresh.expires-minute=${REFRESH_EXPIRES_MINUTE:60}
# cookie
cookie.secure=${COOKIE_SECURE:false}
# --- Actuator 端點暴露 ---
management.endpoints.web.exposure.include=health,metrics,prometheus,info,chat-room
management.endpoint.health.show-details=always
management.health.defaults.enabled=true
management.info.env.enabled=true
# --- Metrics 效能指標 (針對並發測試) ---
# 開啟百分位數直方圖 (為了 Grafana 畫 P95/P99 線)
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.sla.http.server.requests=50ms,100ms,200ms,500ms,1s
# 替所有指標加上應用程式標籤 (方便 Grafana 過濾)
management.metrics.tags.application=${spring.application.name}
management.metrics.tags.environment=development
# --- Tracing 鏈路追蹤 (Jaeger) ---
# 在並發測試時，建議採樣率設為 1.0 (全採樣) 以便觀察每一筆慢請求
#management.tracing.sampling.probability=1.0
management.otlp.tracing.endpoint=${TRACING_ENDPOINT:http://localhost:4317}
# --- R2DBC 監控補充 ---
# 確保 Micrometer 會收集 R2DBC 連線池指標
management.metrics.enable.r2dbc=true
